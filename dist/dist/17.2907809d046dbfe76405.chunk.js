webpackJsonp([17],{230:function(e,t,n){"use strict";function i(e){d||n(424)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(326),a=n.n(s);for(var r in s)"default"!==r&&function(e){n.d(t,e,function(){return s[e]})}(r);var o=n(426),c=n.n(o),d=!1,u=n(6),l=i,h=u(a.a,c.a,!1,l,"data-v-68fcf92c",null);h.options.__file="src/views/communicationManagement/communication/memberRecharge.vue",t.default=h.exports},272:function(e,t,n){"use strict";function i(e,t){for(var n=0;n<e.length;n++)if(e[n].userId===t.userId)return n;return-1}Object.defineProperty(t,"__esModule",{value:!0}),t.default={props:{isRadio:{type:Boolean,default:!1},url:{type:String,default:""},checkedData:{type:Array,default:function(){return[]}}},data:function(){return{checked:[],userList:[],search:"",resList:[],redio:""}},created:function(){this.getUser()},methods:{getUser:function(){var e=this;this.$http({url:this.serviceurl+"/weteam-service/"+this.url,method:"get"}).then(function(t){0===t.data.retCode&&t.data.data&&(e.userList=t.data.data)}).catch(function(e){})},checkChange:function(e){var t=this,n=[];e.forEach(function(e){n.push(t.resList[e])}),this.$emit("val",n)},radioChange:function(e){this.$emit("val",this.resList[e])},searchUser:function(){for(var e=this.userList,t=[],n=new RegExp(this.search),i=0;i<e.length;i++)(e[i].userName&&e[i].userName.match(n)||e[i].userPhone&&e[i].userPhone.match(n))&&t.push(e[i]);this.resList=t,this.checkedChange()},delChecked:function(e){this.checked.splice(e,1)},checkedChange:function(){var e=this;this.checked=[],this.checkedData.forEach(function(t){var n=i(e.resList,t);n>-1&&e.checked.push(n)})}}}},274:function(e,t,n){"use strict";function i(e){d||n(275)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(272),a=n.n(s);for(var r in s)"default"!==r&&function(e){n.d(t,e,function(){return s[e]})}(r);var o=n(277),c=n.n(o),d=!1,u=n(6),l=i,h=u(a.a,c.a,!1,l,"data-v-1ea60565",null);h.options.__file="src/views/my-components/searchUser.vue",t.default=h.exports},275:function(e,t,n){var i=n(276);"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);n(14)("57d962f4",i,!1,{})},276:function(e,t,n){t=e.exports=n(13)(!1),t.push([e.i,"\n.res-list[data-v-1ea60565] {\n  width: 300px;\n  height: 200px;\n  overflow-y: auto;\n  border: 1px solid #dddee1;\n  margin-top: 10px;\n  padding: 10px;\n}\n",""])},277:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("Input",{staticClass:"cc-w-300",attrs:{placeholder:""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),e._v(" "),n("Button",{attrs:{type:"primary"},on:{click:e.searchUser}},[e._v("搜索")]),e._v(" "),n("div",{staticClass:"res-list"},[e.isRadio?n("RadioGroup",{on:{"on-change":e.radioChange},model:{value:e.redio,callback:function(t){e.redio=t},expression:"redio"}},e._l(e.resList,function(t,i){return n("p",{key:i},[n("Radio",{attrs:{label:i}},[e._v(e._s(t.userName+"  ("+t.userPhone+")"))])],1)})):n("CheckboxGroup",{on:{"on-change":e.checkChange},model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}},e._l(e.resList,function(t,i){return n("p",{key:i},[n("Checkbox",{attrs:{label:i}},[e._v(e._s(t.userName+"   ("+t.userPhone+")"))])],1)}))],1)],1)},s=[];i._withStripped=!0;var a={render:i,staticRenderFns:s};t.default=a},326:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(274),s=function(e){return e&&e.__esModule?e:{default:e}}(i);t.default={components:{searchUser:s.default},computed:{totalDenomination:function(){var e=this,t=this.denominationList.filter(function(t){return t.id==e.denomination});return(t[0]?t[0].denomination:0)*(parseInt(this.number)?parseInt(this.number):0)*this.selectedList.length}},data:function(){return{loading:!1,type:null,addModal:!1,userList:[],selectedListCache:[],selectedList:[],denomination:"",denominationList:[],number:0}},created:function(){this.getUser(),this.getDenominationList()},methods:{getUser:function(){var e=this;this.$http({url:this.serviceurl+"/weteam-service/mgt/user/org/list",method:"get"}).then(function(t){if(0===t.data.retCode&&t.data.data){e.userList=t.data.data;var n=e.$store.state.communication.batchRechargeList;n.length>0&&(e.selectedList=e.userList.filter(function(e){if(n.indexOf(e.userId)>-1)return e}))}}).catch(function(e){})},getDenominationList:function(){var e=this;this.$http({url:this.serviceurl+"/weteam-service/mgt/listAllDenomination",method:"get"}).then(function(t){0===t.data.retCode?(e.denominationList=t.data.data,e.denomination=e.denominationList[0]?e.denominationList[0].id:""):e.$Message.warning(t.data.retMsg)}).catch(function(e){})},confirmRecharge:function(){var e=this;return this.loading=!0,0==this.selectedList.length?(this.$Message.warning("请选择要充值的会员!"),void(this.loading=!1)):0==this.number?(this.$Message.warning("请填写充值数量!"),void(this.loading=!1)):(this.selectedList.forEach(function(t){t.id=e.denomination}),void this.$http({url:this.serviceurl+"/weteam-service/mgt/teamRecharge?num="+this.number,method:"post",data:this.selectedList}).then(function(t){0===t.data.retCode?(e.$Message.success(t.data.retMsg||"充值成功！"),e.$router.push({name:"communication"})):e.$Message.warning(t.data.retMsg||"充值失败！"),e.loading=!1}).catch(function(t){e.loading=!1}))},cancel:function(){this.$router.push({name:"communication"})},typeChange:function(e){this.type=e,1==e?(this.selectedList=[],this.addModal=!0):this.selectedList=this.userList},getMemberList:function(e){this.selectedListCache=e},addMember:function(){this.selectedList=this.selectedListCache},delItem:function(e){this.$refs.searchUser.delChecked(e),this.selectedList.splice(e,1)},numberBlur:function(e){""===e&&(this.number=0)},numberKeyup:function(e){/^\d*$/.test(e)||(isNaN(parseInt(e))?this.number=0:this.number=Math.abs(parseInt(e)))}}}},424:function(e,t,n){var i=n(425);"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);n(14)("dd5d4d2c",i,!1,{})},425:function(e,t,n){t=e.exports=n(13)(!1),t.push([e.i,"\n.cont-item[data-v-68fcf92c] {\n  overflow: hidden;\n  margin-bottom: 10px;\n}\n.cont-item label[data-v-68fcf92c] {\n  float: left;\n  width: 80px;\n}\n.cont-item .cont[data-v-68fcf92c] {\n  margin-left: 80px;\n}\n.selected-item[data-v-68fcf92c] {\n  margin: 5px;\n  position: relative;\n  display: inline-block;\n}\n.selected-item .del-item[data-v-68fcf92c] {\n  position: absolute;\n  top: -8px;\n  right: -8px;\n  z-index: 99;\n  font-size: 20px;\n  cursor: pointer;\n}\n",""])},426:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"main-body"},[n("div",{staticClass:"cont-item"},[n("label",[e._v("充值会员：")]),e._v(" "),n("div",{staticClass:"cont"},[n("div",[n("Button",{attrs:{type:0===e.type?"primary":"ghost"},on:{click:function(t){e.typeChange(0)}}},[e._v("全部")]),e._v(" "),n("Button",{attrs:{type:1===e.type?"primary":"ghost"},on:{click:function(t){e.typeChange(1)}}},[e._v("选择其他")])],1),e._v(" "),n("Card",{staticClass:"cc-m-t-10",attrs:{"dis-hover":!0}},e._l(e.selectedList,function(t,i){return n("div",{key:i,staticClass:"selected-item"},[n("Icon",{staticClass:"del-item",attrs:{type:"close-circled"},nativeOn:{click:function(t){e.delItem(i)}}}),e._v(" "),n("Input",{staticClass:"cc-w-150",attrs:{placeholder:"",readonly:""},model:{value:t.userName,callback:function(n){e.$set(t,"userName",n)},expression:"item.userName"}})],1)}))],1)]),e._v(" "),n("div",{staticClass:"cont-item"},[n("label",[e._v("充值面额：")]),e._v(" "),n("div",{staticClass:"cont"},[n("Select",{staticClass:"cc-w-150",model:{value:e.denomination,callback:function(t){e.denomination=t},expression:"denomination"}},e._l(e.denominationList,function(t){return n("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.denomination))])})),e._v(" "),n("Input",{staticClass:"cc-w-150",attrs:{placeholder:""},on:{"on-blur":function(t){e.numberBlur(e.number)},"on-keyup":function(t){e.numberKeyup(e.number)}},model:{value:e.number,callback:function(t){e.number=t},expression:"number"}}),e._v("\n        累计："+e._s(e.totalDenomination)+"\n    ")],1)]),e._v(" "),n("div",{staticClass:"cc-text-center"},[n("Button",{attrs:{type:"primary",loading:e.loading},on:{click:e.confirmRecharge}},[e._v("确定充值")]),e._v(" "),n("Button",{attrs:{type:"ghost"},on:{click:e.cancel}},[e._v("取消")])],1),e._v(" "),n("Modal",{attrs:{title:"选择成员"},on:{"on-ok":e.addMember},model:{value:e.addModal,callback:function(t){e.addModal=t},expression:"addModal"}},[n("searchUser",{key:e.addModal,ref:"searchUser",attrs:{url:"mgt/user/org/list"},on:{val:e.getMemberList}})],1)],1)},s=[];i._withStripped=!0;var a={render:i,staticRenderFns:s};t.default=a}});